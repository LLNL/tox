set echo on
spool tox.bdy.sql.err

-- $Id: tox.bdy.sql 5 2009-10-16 15:20:39Z dacracot $

CREATE OR REPLACE PACKAGE BODY tox
	IS
	/*------------------------------------------------------------------------*/
	/*------------------------------------------------------------------------*/
	/*========================================================================*/
	/*========================================================================*/
	PROCEDURE begin_spool
		AS
		/*-----------------------*/
		/*=======================*/
		BEGIN
		/*=======================*/
			SELECT
				key.NEXTVAL
			INTO
				g_spool_key
			FROM
				DUAL;
		/*=======================*/
		END begin_spool;
	/*========================================================================*/
	PROCEDURE into_spool
		(
		in_txt IN spool.txt%TYPE
		)
		AS
		/*-----------------------*/
		/*=======================*/
		BEGIN
		/*=======================*/
			INSERT INTO
				spool
			VALUES
				(
				g_spool_key,
				in_txt,
				seq.NEXTVAL
				);
		/*=======================*/
		END into_spool;
	/*========================================================================*/
	PROCEDURE reset_spool
		AS
		/*-----------------------*/
		/*=======================*/
		BEGIN
		/*=======================*/
			DELETE
				spool
			WHERE
				key = g_spool_key;
			COMMIT;
			begin_spool;
		/*=======================*/
		END reset_spool;
	/*========================================================================*/
	FUNCTION end_spool
		RETURN t_spool
		AS
		/*-----------------------*/
		v_spool t_spool;
		/*=======================*/
		BEGIN
		/*=======================*/
		/*-----------------------*/
			COMMIT;
			OPEN v_spool FOR
				SELECT
					*
				FROM
					spool
				WHERE
					key = g_spool_key
				ORDER BY
					seq;
			RETURN v_spool;
		/*=======================*/
		END end_spool;
	/*========================================================================*/
	FUNCTION timestamp
		RETURN VARCHAR2
		AS
		/*-----------------------*/
		v_result VARCHAR2(14);
		/*=======================*/
		BEGIN
		/*=======================*/
			SELECT
				TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
			INTO
				v_result
			FROM
				DUAL;
			RETURN v_result;
		/*=======================*/
		END timestamp;
	/*========================================================================*/
	END tox;
	/*========================================================================*/

/

SHOW ERRORS PACKAGE BODY tox;

/*------------------------------------------------------------------------*/

spool off
